// useDispatch hook to call reducers
import {useDispatch,useSelector} from "react-redux";

import React, {useState} from "react";
// import reducer function exported
import {addTodo, deleteTodo, todoDoneToggle} from "./reducers/todos-reducer";

const Todos = () => {
    const todos = useSelector(state => state.todos);
    // all the method declare in useSelector hook in the component
    // the useSelector retrieve all the todos generated by todos-reducer.js
    const [todo, setTodo] = useState({do: ''})
    // get dispacher to invoke reducer functions

    const dispatch =useDispatch();
    // handle checkbox click event, accept todo index
    const toggleTodoDone = (todo) =>{
        // send index to reducer function passing index of todo to toggle done field

        dispatch(todoDoneToggle(todo))
    }
    // handle click event of button
    const deleteTodoClickHandler = (index) =>{
        dispatch((deleteTodo(index)))
    };
    const createTodoClickHandler = () => {
        // call reducer function passing new
        // todo as the payload in the action object
        dispatch(addTodo(todo))
        //then clear local todo state variable
         //   setTodo({do:''})
    }
    const todoChangeHandler = (event) => {
        const doValue = event.target.value;
        const newTodo = {do: doValue};

        setTodo(newTodo);
    }
    return (

         <>
            <h3>Todos</h3>
             <ul className="list-group">
                 <li className="list-group-item">
                     {/*new button to add new todo*/}

                     <button onClick={createTodoClickHandler}
                         className="btn btn-primary w-25 float-end"
                     >Create</button>
                     <input onChange={todoChangeHandler} value={todo.do} className="form-control w-75" />




                     {todo.do}
                 </li>



        {/*return an array of todo retrieved by useSelector*/}

                 {todos.map((todo,index) =>
                        <li key ={todo._id}
                            className="list-group-item">
                            <button onClick={() =>
                                deleteTodoClickHandler(index)}
                            className = "btn btn-danger float-end ms-2" >
                                Delete
                            </button>
                            <input type = "checkbox"  className="me-2"
                                   checked={todo.done}
                                   onChange={()=>toggleTodoDone(todo)}/>
                         {/*      don't forget to pass todo parameter in the toggle function!!!*/}
                         {todo.do}
                         </li>)
                }
             </ul>
         </>
    );
}

export default Todos;